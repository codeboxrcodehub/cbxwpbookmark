import{_ as v,S as k,r as p,o as m,c as y,w as d,a as e,t as l,b as g,d as u,e as S,f as _,v as L,g as q,h,i as C,j as T,k as f,l as R,I,p as M,H as B,A as N}from"./vue-router.js";import{d as U,v as F}from"./VueFinalModal.esm.js";import{W as V}from"./cbxwpbookmark-head.js";import{T as H}from"./TableLite.js";import{d as A,F as E,a as J,E as O}from"./vee-validate.js";import{Z as K}from"./vue3-context-menu.es.js";const D={name:"List",components:{WpHead:V,TableLite:H},async mounted(){let o=[],t=await localStorage.getItem(this.localStorageListingKey);t&&(t=JSON.parse(t),Array.isArray(t)&&t.length&&t.forEach(i=>{i.user_id===this.current_user_id&&(o=i.columns)})),Array.isArray(o)&&o.length===0&&(o=["id","post","post_type","user","category","sort_order","add_date","action"]),this.table_col_show=o,this.table.columns=await this.set_table_columns(),this.$route.query.page&&this.pagination(this.$route.query.page),this.$route.query.limit&&(this.limit=Number(this.$route.query.limit)),this.$route.query.order_by&&this.$route.query.sort&&(this.table.sortable.order=this.$route.query.order_by,this.table.sortable.sort=this.$route.query.sort,this.order_by(this.$route.query.order_by,this.$route.query.sort)),this.$route.query.date_filter&&(this.date_filter=this.$route.query.date_filter),this.$route.query.date_filter_type&&(this.date_filter_type=this.$route.query.date_filter_type),this.setFilterFromLoacalStorage()},watch:{table_col_show:{deep:!0,handler(o){let t={user_id:this.current_user_id,columns:o},i=JSON.parse(localStorage.getItem(this.localStorageListingKey)),n=!1;i?(i.forEach((s,r)=>{s.user_id===this.current_user_id&&(i[r].columns=o,n=!0)}),n===!1&&i.push(t),localStorage.setItem(this.localStorageListingKey,JSON.stringify(i))):localStorage.setItem(this.localStorageListingKey,JSON.stringify([t])),this.table.columns=this.set_table_columns()}}},data(){return{cbxwpbookmark_vue_var,current_user_id:cbxwpbookmark_vue_var==null?void 0:cbxwpbookmark_vue_var.user_data.id,table_col_show:[],localStorageListingKey:"cbxwpbookmark_log_list",dataLoading:!1,cbx_table_lite:cbxwpbookmark_vue_var.cbx_table_lite,userRoles:cbxwpbookmark_vue_var.user_roles,filterStatus:"",table:{isLoading:!0,columns:[],rows:[],totalRecordCount:0,sortable:{order:"id",sort:"desc"}},paginationInfo:{},queryStr:"",limit:10,searchText:"",selectedRows:[],total_count:0,translations:cbxwpbookmark_vue_var.translation}},methods:{async doSearch(o,t,i,n,s=1){this.limit=t,await this.pagination(s),this.table.sortable.order=i,this.table.sortable.sort=n,await this.order_by(this.table.sortable.order,this.table.sortable.sort),this.table.isLoading=!0,this.$router.push("/?"+this.queryStr),this.axios.get(cbxwpbookmark_vue_var.rest_end_points.adminGetBookmarks+"?"+this.queryStr).then(r=>{var b;r.data.success?(this.total_count=r.data.data.total,this.table.rows=r.data.data.data,delete r.data.data.data,this.paginationInfo=r.data.data,this.table.totalRecordCount=this.paginationInfo.total):(this.errorMessage((b=r==null?void 0:r.data)==null?void 0:b.info),this.paginationInfo={},this.table.rows=[]),this.dataLoading=!1}).catch(r=>{this.dataLoading=!1,this.paginationInfo={},this.table.rows=[],this.errorMessage(r)})},pagination(o){let t=new URLSearchParams(this.queryStr);o?t.set("page",o):t.delete("page"),this.limit?t.set("limit",this.limit):t.delete("limit"),this.queryStr=t.toString()},async order_by(o,t){let i=new URLSearchParams(this.queryStr);this.queryStr=i.toString(),o?i.set("order_by",o):i.delete("order_by"),t?i.set("sort",t):i.delete("sort"),await this.handleLocalStorage("order",o),await this.handleLocalStorage("sort",t),this.queryStr=i.toString()},deleteBookmark(o){k.fire({title:cbxwpbookmark_vue_var.translation.delete_confirmation_title,text:cbxwpbookmark_vue_var.translation.delete_confirmation_txt,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",customClass:{container:"swal2-container-cbx"},confirmButtonText:cbxwpbookmark_vue_var.translation.delete_btn_txt}).then(t=>{t.isConfirmed&&this.axios.get(cbxwpbookmark_vue_var.rest_end_points.deleteBookmark+"?id="+o).then(i=>{i.data.success?(this.successMessage(i.data.info),this.selectedRows=[],this.doSearch(0,this.limit,this.table.sortable.order,this.table.sortable.sort)):this.errorMessage(i.data.info)}).catch(i=>{})})},async searchUser(){this.dataLoading=!0;let o=new URLSearchParams(this.queryStr);this.searchText?o.set("search",this.searchText):o.delete("search"),await this.handleLocalStorage("search",this.searchText),this.queryStr=o.toString(),await this.doSearch(0,this.limit,this.table.sortable.order,this.table.sortable.sort)},async searchUserFromLocalStorage(){this.dataLoading=!0;let o=new URLSearchParams(this.queryStr);this.searchText?o.set("search",this.searchText):o.delete("search"),this.table.sortable.sort&&o.set("sort",this.table.sortable.sort),this.table.sortable.order&&o.set("order_by",this.table.sortable.order),this.queryStr=o.toString(),await this.doSearch(0,this.limit,this.table.sortable.order,this.table.sortable.sort)},async setFilterFromLoacalStorage(){let o=await JSON.parse(localStorage.getItem("cbxwpbookmark_log_filters"));o&&o.forEach((t,i)=>{t.user_id===this.current_user_id&&(t!=null&&t.search&&!this.$route.query.search&&(this.searchText=t.search),t!=null&&t.sort&&!this.$route.query.sort&&(this.table.sortable.sort=t.sort),t!=null&&t.order&&!this.$route.query.order_by&&(this.table.sortable.order=t.order))}),await this.searchUserFromLocalStorage()},async handleLocalStorage(o,t){if(t){let i=await JSON.parse(localStorage.getItem("cbxwpbookmark_log_filters"));i?(i.forEach((n,s)=>{n.user_id===this.current_user_id&&(i[s][o]=t)}),await localStorage.setItem("cbxwpbookmark_log_filters",JSON.stringify(i))):(i={user_id:this.current_user_id,[o]:this.filterValue},await localStorage.setItem("cbxwpbookmark_log_filters",JSON.stringify([i])))}else{let i=await JSON.parse(localStorage.getItem("cbxwpbookmark_log_filters"));i&&(i.forEach((n,s)=>{n.user_id===this.current_user_id&&delete i[s][o]}),await localStorage.setItem("cbxwpbookmark_log_filters",JSON.stringify(i)))}},clearFilter(){this.searchText="",this.searchUser()},checkedRows(o){this.selectedRows=o.map(t=>Number(t))},deleteSelectedItems(){k.fire({title:cbxwpbookmark_vue_var.translation.delete_confirmation_title,text:cbxwpbookmark_vue_var.translation.delete_confirmation_txt,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:cbxwpbookmark_vue_var.translation.delete_btn_txt,customClass:{container:"swal2-container-cbx"}}).then(o=>{o.isConfirmed&&this.axios.get(cbxwpbookmark_vue_var.rest_end_points.deleteBookmark+"?id="+this.selectedRows.join(",")).then(t=>{if(t.data.success){this.successMessage(t.data.info),this.selectedRows=[];const i=document.querySelectorAll(".vtl-tbody-checkbox");typeof i<"u"&&i&&i.forEach(n=>{n.checked=!1}),document.querySelector(".vtl-thead-checkbox").checked=!1,this.doSearch(0,this.limit,this.table.sortable.order,this.table.sortable.sort)}else this.errorMessage(t.data.info)}).catch(t=>{this.errorMessage(t)})})},set_table_columns(){return[{label:cbxwpbookmark_vue_var.translation.id,field:"id",sortable:!0,isKey:!0,is_show:this.table_col_show.includes("id")},{label:cbxwpbookmark_vue_var.translation.post,field:"post",is_show:this.table_col_show.includes("post")},{label:cbxwpbookmark_vue_var.translation.post_type,field:"object_type",is_show:this.table_col_show.includes("post_type"),sortable:!0},{label:cbxwpbookmark_vue_var.translation.user,field:"user",is_show:this.table_col_show.includes("user")},{label:cbxwpbookmark_vue_var.translation.category,field:"category",is_show:this.table_col_show.includes("category")},{label:cbxwpbookmark_vue_var.translation.addDate,field:"created_date",is_show:this.table_col_show.includes("add_date"),sortable:!0},{label:cbxwpbookmark_vue_var.translation.sort_order,field:"sort_order",is_show:this.table_col_show.includes("sort_order")},{label:cbxwpbookmark_vue_var.translation.action,field:"action",sortable:!1,is_show:!0}]}}},P={class:"inside"},j={class:"container"},W={class:"row"},z={class:"col-12"},Z={class:"cbx-sub-heading-wrap",id:"dashlisting_toolbar"},G={class:"cbx-sub-heading-l"},X={class:"cbx-sub-heading cbx-sub-heading-bookmark cbx-sub-heading-bookmarklist"},Q={class:"cbx-listing-table-prebox-wrap cbx-listing-table-prebox-wrap-bookmark cbx-listing-table-prebox-wrap-bookmarklist"},Y={class:"container"},$={class:"row"},tt={class:"col col-12"},et={class:"cbx-listing-table-prebox-l pull-left"},st=["title"],ot={class:"cbx-icon"},it={class:"button-label"},at={class:"sr-only"},rt={class:"cbx-listing-table-prebox-r pull-right"},lt=["placeholder"],nt=["title"],ct={key:0,class:"cbx-icon cbx-icon-search-white"},_t={key:1,class:"cbx-icon cbx-icon-refresh-white"},bt={class:"sr-only"},ht=["title"],dt={class:"cbx-icon"},ut={class:"sr-only"},mt={class:"dropdown dropdown-menu ml-10"},pt=["title","aria-label"],gt={class:"cbx-icon"},kt={class:"sr-only"},ft={class:"card card-menu card-menu-right"},wt={class:"checkbox_field"},xt={for:"id"},vt={class:"mt-5"},yt={class:"checkbox_field"},St={for:"post"},Lt={class:"mt-5"},qt={class:"checkbox_field"},Ct={for:"post_type"},Tt={class:"mt-5"},Rt={class:"checkbox_field"},It={for:"user"},Mt={class:"mt-5"},Bt={class:"checkbox_field"},Nt={for:"category"},Ut={class:"mt-5"},Ft={class:"checkbox_field"},Vt={for:"add_date"},Ht={class:"mt-5"},At={class:"checkbox_field"},Et={for:"action"},Jt={class:"container"},Ot=["innerHTML"],Kt=["innerHTML"],Dt=["innerHTML"],Pt=["href"],jt={class:"button_actions"},Wt=["onClick","title"],zt={class:"cbx-icon"},Zt={class:"button-label"};function Gt(o,t,i,n,s,r){const b=p("inline-svg"),w=p("table-lite"),x=p("wp-head");return m(),y(x,{heading:s.translations.bookmark_manager,"class-name":"cbxwpbookmark-page-listing cbxwpbookmark-page-listing-bookmarks"},{default:d(()=>[e("div",P,[e("div",j,[e("div",W,[e("div",z,[e("div",Z,[e("div",G,[e("h2",X,l(s.translations.bookmark_list_heading),1)]),t[13]||(t[13]=e("div",{class:"cbx-sub-heading-r"},null,-1))])])])]),t[14]||(t[14]=e("div",{class:"cbx-listing-table-filters-wrap cbx-listing-table-filters-wrap-bookmark cbx-listing-table-filters-wrap-bookmarklist"},[e("div",{class:"container"},[e("div",{class:"row"},[e("div",{class:"col-12"},[e("div",{class:"cbx-listing-table-filters"})])])])],-1)),e("div",Q,[e("div",Y,[e("div",$,[e("div",tt,[e("div",et,[e("h3",null,l(s.translations.total)+": "+l(s.total_count),1),s.selectedRows.length>0?(m(),g("button",{key:0,role:"button",class:"button error icon icon-inline ml-5",onClick:t[0]||(t[0]=(...a)=>r.deleteSelectedItems&&r.deleteSelectedItems(...a)),title:s.translations.delete_all},[e("i",ot,[u(b,{src:s.cbxwpbookmark_vue_var.icons_url+"icon_delete.svg"},null,8,["src"])]),e("span",it,l(s.translations.delete_all)+" ("+l(s.selectedRows.length)+")",1),e("span",at,l(s.translations.buttons.delete.sr_label),1)],8,st)):S("",!0)]),e("div",rt,[_(e("input",{style:{display:"inline-block","margin-right":"10px"},type:"text",class:"form-control",placeholder:s.translations.searchText,"onUpdate:modelValue":t[1]||(t[1]=a=>s.searchText=a),onKeyup:t[2]||(t[2]=q(a=>r.searchUser(),["enter"]))},null,40,lt),[[L,s.searchText]]),e("button",{role:"button",class:"button primary icon icon-only",onClick:t[3]||(t[3]=a=>r.searchUser()),title:s.translations.buttons.search.title},[this.dataLoading?(m(),g("i",_t)):(m(),g("i",ct)),e("span",bt,l(s.translations.buttons.search.sr_label),1)],8,nt),e("button",{role:"button",class:"button secondary icon icon-only icon-inline ml-5",onClick:t[4]||(t[4]=a=>r.clearFilter()),title:s.translations.buttons.reset.title},[e("i",dt,[u(b,{src:s.cbxwpbookmark_vue_var.icons_url+"icon_reset.svg"},null,8,["src"])]),e("span",ut,l(s.translations.buttons.reset.sr_label),1)],8,ht),e("details",mt,[e("summary",{class:"button outline primary icon icon-only",title:s.translations.buttons.filter.title,"aria-label":s.translations.buttons.filter.title},[e("i",gt,[u(b,{src:s.cbxwpbookmark_vue_var.icons_url+"icon_funnel.svg"},null,8,["src"])]),e("span",kt,l(s.translations.buttons.filter.sr_label),1)],8,pt),e("div",ft,[e("ul",null,[e("li",null,[e("div",wt,[_(e("input",{type:"checkbox",class:"magic-checkbox",id:"id",value:"id","onUpdate:modelValue":t[5]||(t[5]=a=>s.table_col_show=a)},null,512),[[h,s.table_col_show]]),e("label",xt,l(s.translations.id),1)])]),e("li",vt,[e("div",yt,[_(e("input",{type:"checkbox",class:"magic-checkbox",id:"post","onUpdate:modelValue":t[6]||(t[6]=a=>s.table_col_show=a),value:"post"},null,512),[[h,s.table_col_show]]),e("label",St,l(s.translations.post),1)])]),e("li",Lt,[e("div",qt,[_(e("input",{type:"checkbox",class:"magic-checkbox",id:"post_type","onUpdate:modelValue":t[7]||(t[7]=a=>s.table_col_show=a),value:"post_type"},null,512),[[h,s.table_col_show]]),e("label",Ct,l(s.translations.post_type),1)])]),e("li",Tt,[e("div",Rt,[_(e("input",{type:"checkbox",class:"magic-checkbox",id:"user","onUpdate:modelValue":t[8]||(t[8]=a=>s.table_col_show=a),value:"user"},null,512),[[h,s.table_col_show]]),e("label",It,l(s.translations.user),1)])]),e("li",Mt,[e("div",Bt,[_(e("input",{type:"checkbox",class:"magic-checkbox",id:"category","onUpdate:modelValue":t[9]||(t[9]=a=>s.table_col_show=a),value:"category"},null,512),[[h,s.table_col_show]]),e("label",Nt,l(s.translations.category),1)])]),e("li",Ut,[e("div",Ft,[_(e("input",{type:"checkbox",class:"magic-checkbox",id:"add_date","onUpdate:modelValue":t[10]||(t[10]=a=>s.table_col_show=a),value:"add_date"},null,512),[[h,s.table_col_show]]),e("label",Vt,l(s.translations.addDate),1)])]),e("li",Ht,[e("div",At,[_(e("input",{type:"checkbox",class:"magic-checkbox",id:"action","onUpdate:modelValue":t[11]||(t[11]=a=>s.table_col_show=a),value:"action",disabled:""},null,512),[[h,s.table_col_show]]),e("label",Et,l(s.translations.action),1)])])])])])])])])])]),e("div",Jt,[u(w,{translations:s.cbx_table_lite,messages:{pagingInfo:s.translations.showing+" {0}-{1} "+s.translations.of+" {2}",pageSizeChangeLabel:s.translations.rowCount,gotoPageLabel:"     "+s.translations.goTo,noDataAvailable:s.translations.noBookmarkList},class:"cbx-listing-table cbx-listing-table-bookmark cbx-listing-table-bookmarklist mt-0","is-slot-mode":!0,"is-loading":s.table.isLoading,columns:s.table.columns,rows:s.table.rows,total:s.table.totalRecordCount,sortable:s.table.sortable,"page-size":s.limit,"has-checkbox":!0,onDoSearch:r.doSearch,onIsFinished:t[12]||(t[12]=a=>s.table.isLoading=!1),onReturnCheckedRows:r.checkedRows},{post:d(a=>[e("span",{innerHTML:a.value.object_link},null,8,Ot)]),created_date:d(a=>[e("span",{innerHTML:a.value.formatted_created_date},null,8,Kt)]),user:d(a=>[e("span",{innerHTML:a.value.user_link},null,8,Dt)]),category:d(a=>[e("a",{href:s.cbxwpbookmark_vue_var.admin_url+"admin.php?page=cbxwpbookmark-cats#/edit/"+a.value.cat_id,target:"_blank"},l(a.value.category.cat_name),9,Pt)]),action:d(a=>[e("div",jt,[e("a",{role:"button",target:"_blank",class:"button error icon icon-inline small",onClick:$t=>r.deleteBookmark(a.value.id),title:s.translations.buttons.delete.title},[e("i",zt,[u(b,{src:s.cbxwpbookmark_vue_var.icons_url+"icon_delete.svg"},null,8,["src"])]),e("span",Zt,l(s.translations.delete),1)],8,Wt)])]),_:1},8,["translations","messages","is-loading","columns","rows","total","sortable","page-size","onDoSearch","onReturnCheckedRows"])])])]),_:1},8,["heading"])}const Xt=v(D,[["render",Gt]]),Qt=C(),Yt=T({history:Qt,routes:[{path:"/",component:Xt}]});A("required",o=>!!o||"This field is required.");f.defaults.headers.common["X-WP-Nonce"]=cbxwpbookmark_vue_var.rest_nonce;const c=R(N);c.use(U);c.use(F({key:"$vfm",componentName:"VueFinalModal",dynamicContainerName:"ModalsContainer"}));c.component("inline-svg",I);c.use(M,f);c.use(B);c.use(K);c.component("Form",E);c.component("Field",J);c.component("ErrorMessage",O);c.use(Yt).mount("#cbxwpbookmark-log-listing");
